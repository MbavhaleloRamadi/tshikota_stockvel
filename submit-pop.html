<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Submit your proof of payment - Tshikota Ro Farana Stokvel">
    <meta name="theme-color" content="#1B5E20">
    <title>Submit POP - Tshikota Ro Farana</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <!-- Header -->
    <header class="page-header">
        <a href="index.html" class="back-button">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="15 18 9 12 15 6"/>
            </svg>
            <span>Back</span>
        </a>
        <h1 class="page-title">POP Submission</h1>
        <div class="header-spacer"></div>
    </header>

    <!-- Main Content -->
    <main class="container page-content">
        <!-- Form Section -->
        <form id="pop-form" class="form" novalidate>
            <!-- Personal Details -->
            <section class="form-section">
                <h2 class="form-section-title">Personal Details</h2>
                
                <div class="form-group">
                    <label for="fullName" class="form-label">Full Name <span class="required">*</span></label>
                    <input 
                        type="text" 
                        id="fullName" 
                        name="fullName" 
                        class="form-input" 
                        placeholder="Enter your full name"
                        required
                        autocomplete="name"
                    >
                    <span class="form-error"></span>
                </div>

                <div class="form-group">
                    <label for="phone" class="form-label">Phone Number <span class="required">*</span></label>
                    <input 
                        type="tel" 
                        id="phone" 
                        name="phone" 
                        class="form-input" 
                        placeholder="e.g., 0821234567"
                        required
                        autocomplete="tel"
                        pattern="[0-9]{10}"
                    >
                    <span class="form-hint">10-digit SA mobile number</span>
                    <span class="form-error"></span>
                </div>
            </section>

            <!-- Payment Details -->
            <section class="form-section">
                <h2 class="form-section-title">Payment Details</h2>

                <div class="form-group">
                    <label for="amount" class="form-label">Amount Paid (R) <span class="required">*</span></label>
                    <input 
                        type="number" 
                        id="amount" 
                        name="amount" 
                        class="form-input" 
                        placeholder="300"
                        required
                        min="1"
                        step="1"
                        inputmode="numeric"
                    >
                    <span class="form-hint">Minimum R300 per month</span>
                    <span class="form-error"></span>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="paymentDate" class="form-label">Payment Date <span class="required">*</span></label>
                        <input 
                            type="date" 
                            id="paymentDate" 
                            name="paymentDate" 
                            class="form-input"
                            required
                        >
                        <span class="form-error"></span>
                    </div>

                    <div class="form-group">
                        <label for="paymentMonth" class="form-label">For Month <span class="required">*</span></label>
                        <select id="paymentMonth" name="paymentMonth" class="form-select" required>
                            <option value="">Select month</option>
                        </select>
                        <span class="form-error"></span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="paymentMethod" class="form-label">Payment Method <span class="required">*</span></label>
                    <select id="paymentMethod" name="paymentMethod" class="form-select" required>
                        <option value="">Select method</option>
                        <option value="eft">EFT / Bank Transfer</option>
                        <option value="cash">Cash Deposit</option>
                        <option value="ewallet">eWallet</option>
                        <option value="other">Other</option>
                    </select>
                    <span class="form-error"></span>
                </div>
            </section>

            <!-- Proof Upload -->
            <section class="form-section">
                <h2 class="form-section-title">Proof of Payment</h2>

                <div class="form-group">
                    <label class="form-label">Upload Proof <span class="required">*</span></label>
                    <div class="file-upload" id="fileUpload">
                        <input 
                            type="file" 
                            id="proofFile" 
                            name="proofFile"
                            accept="image/*,.pdf"
                            class="file-input"
                            required
                            title="Upload proof of payment document"
                        >
                        <div class="file-upload-content">
                            <div class="file-upload-icon">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
                                    <circle cx="8.5" cy="8.5" r="1.5"/>
                                    <polyline points="21 15 16 10 5 21"/>
                                </svg>
                            </div>
                            <p class="file-upload-text">Tap to upload or drag and drop</p>
                            <p class="file-upload-hint">JPG, PNG, or PDF (max 5MB)</p>
                        </div>
                        <div class="file-preview" id="filePreview" style="display: none;">
                            <img id="previewImage" src="" alt="Preview">
                            <div class="file-preview-info">
                                <span id="fileName"></span>
                                <span id="fileSize"></span>
                            </div>
                            <button type="button" class="file-remove" id="removeFile">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="18" y1="6" x2="6" y2="18"/>
                                    <line x1="6" y1="6" x2="18" y2="18"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <span class="form-error" id="fileError"></span>
                </div>
            </section>

            <!-- Notes -->
            <section class="form-section">
                <div class="form-group">
                    <label for="notes" class="form-label">Notes (Optional)</label>
                    <textarea 
                        id="notes" 
                        name="notes" 
                        class="form-textarea" 
                        placeholder="Any additional information..."
                        rows="3"
                    ></textarea>
                </div>
            </section>

            <!-- Late Payment Warning -->
            <div class="info-box info-box-warning" id="lateWarning" style="display: none;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
                    <line x1="12" y1="9" x2="12" y2="13"/>
                    <line x1="12" y1="17" x2="12.01" y2="17"/>
                </svg>
                <div>
                    <strong>Late Payment Notice</strong>
                    <p>Payment after the 7th will incur a R50 fine.</p>
                </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary btn-block" id="submitBtn">
                <span class="btn-text">Submit Payment Proof</span>
                <span class="btn-loading" style="display: none;">
                    <span class="spinner"></span>
                    Submitting...
                </span>
            </button>
        </form>

        <!-- Banking Details -->
        <section class="banking-details">
            <h3 class="banking-title">Banking Details</h3>
            <div class="banking-card">
                <div class="banking-row">
                    <span class="banking-label">Bank</span>
                    <span class="banking-value" id="bankName">First National Bank</span>
                </div>
                <div class="banking-row">
                    <span class="banking-label">Account Name</span>
                    <span class="banking-value" id="accountName">Stokvel</span>
                </div>
                <div class="banking-row">
                    <span class="banking-label">Account Number</span>
                    <span class="banking-value copyable" id="accountNumber" data-copy="63190192880">
                        63190192880
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                        </svg>
                    </span>
                </div>
                <div class="banking-row">
                    <span class="banking-label">Branch Code</span>
                    <span class="banking-value" id="branchCode">250655</span>
                </div>
                <div class="banking-row">
                    <span class="banking-label">Reference</span>
                    <span class="banking-value highlight">Your Name + Phone</span>
                </div>
            </div>
        </section>
    </main>

    <!-- Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-backdrop"></div>
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-icon success">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="20 6 9 17 4 12"/>
                    </svg>
                </div>
                <h2 class="modal-title">Payment Submitted!</h2>
                <p class="modal-message">Your proof of payment has been submitted for review.</p>
                <div class="reference-box">
                    <span class="reference-label">Reference Number</span>
                    <span class="reference-value" id="referenceNumber">TRF-XXXXXX</span>
                </div>
                <p class="modal-note">Please save this reference for your records.</p>
                <button class="btn btn-primary btn-block" id="doneBtn">Done</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>

    <!-- App Scripts -->
    <script src="js/firebase-config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/database.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/app.js"></script>
    <script src="js/submit-pop.js"></script>
</body>
</html>
